package com.example.gestculture.DAO;

import android.content.Context;
import android.database.sqlite.SQLiteDatabase;
import android.database.sqlite.SQLiteStatement;

import com.example.gestculture.Metier.Exploitation;
import com.example.gestculture.SQLHelper.SQLiteHelper;

public class ExploitantDAO {

    private SQLiteDatabase db;
    private final SQLiteHelper dbHelper;

    public ExploitantDAO(Context context) {

        dbHelper = SQLiteHelper.getInstance(context);
    }

    public void open() {

        db = dbHelper.getWritableDatabase();
    }

    public void close() {

        dbHelper.close();
    }

    public void insertExploitant(Exploitation exploitation) {
        String sql = "INSERT INTO exploitation (IdExploitation, IdExploitant) VALUES (?, ?)";
        SQLiteStatement statement = db.compileStatement(sql);
        statement.bindString(1, String.valueOf(exploitation.getIdExploitation()));
        statement.bindString(2, String.valueOf(exploitation.getIdExploitant()));
        statement.executeInsert();
    }



    public void updateExploitant(Exploitation exploitation) {
        String sql = "UPDATE exploitation SET IdExploitation = ?, IdExploitant = ? WHERE IdExploitation = ?";
        SQLiteStatement statement = db.compileStatement(sql);
        statement.bindString(1, String.valueOf(exploitation.getIdExploitation()));
        statement.bindString(2, String.valueOf(exploitation.getIdExploitant()));
        statement.executeUpdateDelete();
    }


    public void deleteExploitant(Exploitation exploitation) {
        String sql = "DELETE FROM exploitation WHERE IdExploitation = ? AND IdExploitant = ?";
        SQLiteStatement statement = db.compileStatement(sql);
        statement.bindLong(1, exploitation.getIdExploitation());
        statement.bindLong(2, exploitation.getIdExploitant());
        statement.executeUpdateDelete();
    }

}
